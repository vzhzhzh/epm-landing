var A=Object.defineProperty;var K=(l,o,e)=>o in l?A(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e;var w=(l,o,e)=>K(l,typeof o!="symbol"?o+"":o,e);import{j as u,t as Y}from"./bundle-mjs.BglWWEXk.js";import{u as q,a as I,c as _,b as T}from"./dialog.B-fI56Xx.js";import{c as D}from"./clsx.B-dksMZM.js";import{r as a}from"./index.CBlmr9og.js";import"./buffer.BPDYedtS.js";import{S as V}from"./sprite.BCEAcEq8.js";import{b as P,g as C,N as J,i as M,A as U}from"./floating-ui.utils.dom.5K4CvxvD.js";import{T as G,o as L,i as $,a as Q}from"./useTimeout.CjVVMpjz.js";import{i as Z}from"./isFunction.BGFdVicR.js";import"./index.CMF_dOlt.js";function ee(){}let X={},W={},z="";function te(l){if(typeof document>"u")return!1;const o=L(l);return C(o).innerWidth-o.documentElement.clientWidth>0}function oe(l){const o=L(l),e=o.documentElement,n=o.body,s=M(e)?e:n,c=s.style.overflow;return s.style.overflow="hidden",()=>{s.style.overflow=c}}function re(l){var v,b,x;const o=L(l),e=o.documentElement,n=o.body,s=C(e);let c=0,m=0;const d=U.create(),p=typeof CSS<"u"&&((v=CSS.supports)==null?void 0:v.call(CSS,"scrollbar-gutter","stable"));if(Q&&((x=(b=s.visualViewport)==null?void 0:b.scale)!=null?x:1)!==1)return()=>{};function i(){const g=s.getComputedStyle(e),h=s.getComputedStyle(n),k=(g.scrollbarGutter||"").includes("both-edges")?"stable both-edges":"stable";c=e.scrollTop,m=e.scrollLeft,X={scrollbarGutter:e.style.scrollbarGutter,overflowY:e.style.overflowY,overflowX:e.style.overflowX},z=e.style.scrollBehavior,W={position:n.style.position,height:n.style.height,width:n.style.width,boxSizing:n.style.boxSizing,overflowY:n.style.overflowY,overflowX:n.style.overflowX,scrollBehavior:n.style.scrollBehavior};const t=e.scrollHeight>e.clientHeight,r=e.scrollWidth>e.clientWidth,f=g.overflowY==="scroll"||h.overflowY==="scroll",S=g.overflowX==="scroll"||h.overflowX==="scroll",j=Math.max(0,s.innerWidth-e.clientWidth),F=Math.max(0,s.innerHeight-e.clientHeight),B=parseFloat(h.marginTop)+parseFloat(h.marginBottom),H=parseFloat(h.marginLeft)+parseFloat(h.marginRight),N=M(e)?e:n;if(p){e.style.scrollbarGutter=k,N.style.overflowY="hidden",N.style.overflowX="hidden";return}Object.assign(e.style,{scrollbarGutter:k,overflowY:"hidden",overflowX:"hidden"}),(t||f)&&(e.style.overflowY="scroll"),(r||S)&&(e.style.overflowX="scroll"),Object.assign(n.style,{position:"relative",height:B||F?"calc(100dvh - ".concat(B+F,"px)"):"100dvh",width:H||j?"calc(100vw - ".concat(H+j,"px)"):"100vw",boxSizing:"border-box",overflow:"hidden",scrollBehavior:"unset"}),n.scrollTop=c,n.scrollLeft=m,e.setAttribute("data-base-ui-scroll-locked",""),e.style.scrollBehavior="unset"}function y(){Object.assign(e.style,X),Object.assign(n.style,W),p||(e.scrollTop=c,e.scrollLeft=m,e.removeAttribute("data-base-ui-scroll-locked"),e.style.scrollBehavior=z)}function E(){y(),d.request(i)}return i(),s.addEventListener("resize",E),()=>{d.cancel(),y(),s.removeEventListener&&s.removeEventListener("resize",E)}}class ne{constructor(){w(this,"lockCount",0);w(this,"restore",null);w(this,"timeoutLock",G.create());w(this,"timeoutUnlock",G.create());w(this,"release",()=>{this.lockCount-=1,this.lockCount===0&&this.restore&&this.timeoutUnlock.start(0,this.unlock)});w(this,"unlock",()=>{var o;this.lockCount===0&&this.restore&&((o=this.restore)==null||o.call(this),this.restore=null)})}acquire(o){return this.lockCount+=1,this.lockCount===1&&this.restore===null&&this.timeoutLock.start(0,()=>this.lock(o)),this.release}lock(o){if(this.lockCount===0||this.restore!==null)return;const n=L(o).documentElement,s=C(n).getComputedStyle(n).overflowY;if(s==="hidden"||s==="clip"){this.restore=J;return}const c=$||!te(o);this.restore=c?oe(o):re(o)}}const le=new ne;function se(l=!0,o=null){P(()=>{if(l)return le.acquire(o)},[l,o])}const ie=l=>{const{referenceElement:o}=l;return se(!0,o.current),null},ye=({closeButtonTitle:l,children:o})=>{const e=a.useRef(null),n=a.useRef(null),s=a.useRef(null),c=a.useRef(null),m=a.useRef(null),d=a.useRef(!1),p=a.useRef(!1),i=q(T),y=()=>{const t=e.current;e.current=null,t&&t instanceof HTMLElement&&"focus"in t&&Z(t.focus)&&t.focus({preventScroll:!0})},E=()=>{!i||d.current||(y(),T.set(!1),p.current=!1)},v=()=>{i&&(p.current=!0,d.current=!1,E())},b=a.useEffectEvent(()=>{i&&(d.current=!0)}),x=a.useEffectEvent(()=>{i&&(d.current=!1)}),g=a.useEffectEvent(t=>{if(!(i&&m.current)||p.current)return;const r=t.target;!(r&&r instanceof HTMLElement)||m.current.contains(r)||v()});a.useLayoutEffect(()=>{const t={passive:!0},r="focus",f="blur",S="focusin";return I.set(!0),window.addEventListener(f,b,t),window.addEventListener(r,x,t),document.addEventListener(S,g,t),()=>{I.set(!1),window.removeEventListener(f,b,t),window.removeEventListener(r,x,t),document.removeEventListener(S,g,t)}},[]),a.useLayoutEffect(()=>{if(!(i&&c.current))return ee;e.current=document.activeElement,(s.current?s.current:c.current).focus({preventScroll:!0})},[i]);const h=t=>{n.current=t;let r;if(t){const f=()=>t.querySelector("iframe");c.current=f(),c.current||(r=new MutationObserver(()=>{c.current=f(),r==null||r.disconnect(),r=void 0}),r.observe(t,{childList:!0}))}return()=>{r==null||r.disconnect(),r=void 0,e.current=null,n.current=null,c.current=null,d.current=!1}},O=a.useEffectEvent(t=>{var f;if(!t.data||typeof t.data!="string")return;let r;try{if(r=JSON.parse(t.data),!r)throw new Error("Невалидный JSON")}catch(S){return}switch(!0){case r.func==="amoformsSuccessSubmit":{(f=window.ym)==null||f.call(window,103900658,"reachGoal","amoforms_send");return}default:return}});a.useEffect(()=>{const t="message",r={passive:!0};return window.addEventListener(t,O,r),()=>{window.removeEventListener(t,O,r)}},[]);const R=t=>{if(i)switch(t.key){case"Escape":t.preventDefault(),v();return;default:return}},k=t=>{if(i)switch(!0){case(t.shiftKey&&t.key==="Tab"):t.preventDefault(),y();return;default:return}};return u.jsxs(u.Fragment,{children:[i&&u.jsx(ie,{referenceElement:n}),u.jsxs("div",{"aria-hidden":!i,className:Y("pointer-events-none w-full select-none opacity-0 transition-opacity",D({"pointer-events-auto select-auto opacity-100":i})),ref:m,role:"none",children:[u.jsx("div",{"aria-hidden":"true",className:"fixed inset-0 min-h-dvh select-none bg-backdrop text-on-backdrop opacity-20 transition-all duration-150 supports-[-webkit-touch-callout:none]:absolute",onClick:v,role:"none"}),u.jsx("div",{"aria-modal":"true",className:"fixed inset-0 m-auto flex max-h-screen min-h-full w-full min-w-0 flex-col overflow-y-auto bg-[#132d40] text-on-secondary shadow outline-offset-0 supports-h-dvh:min-h-dvh 2xl:max-h-[calc(100vh-4rem)] 2xl:min-h-0 2xl:max-w-270 2xl:rounded-2xl 2xl:outline-2 2xl:outline-primary",id:_,onKeyDown:R,ref:h,role:"dialog",tabIndex:-1,children:u.jsxs("div",{className:"relative h-full w-full overflow-auto",role:"none",children:[u.jsxs("div",{className:"relative z-10 h-full w-full grow",role:"none",children:[u.jsx("div",{className:"pointer-events-none absolute inset-0 h-full w-full select-none border-none outline-transparent",onKeyDown:k,ref:s,role:"none",tabIndex:0}),o]}),u.jsx("div",{className:"absolute top-0 right-2 z-50 2xl:top-0 2xl:right-0 rtl:right-auto rtl:left-2 rtl:2xl:right-auto rtl:2xl:left-0",role:"none",children:u.jsx("button",{"aria-label":l,className:Y("cursor-pointer rounded-2xl p-4 outline-offset-0",D({hidden:!i})),onClick:v,type:"button",children:u.jsx(V,{height:"24",id:"close_current_color",width:"24"})})})]})})]})]})};export{ye as BookingFormDialogWrapper};
