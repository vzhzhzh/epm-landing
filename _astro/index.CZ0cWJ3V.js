const S={},g=new Set,l=new WeakSet;let c=!0,u="viewport",v=!1;function N(e){var t,n;v||(v=!0,c!=null||(c=(t=e==null?void 0:e.prefetchAll)!=null?t:!1),u!=null||(u=(n=e==null?void 0:e.defaultStrategy)!=null?n:"hover"),E(),L(),T(),k())}function E(){for(const e of["touchstart","mousedown"])document.addEventListener(e,t=>{s(t.target,"tap")&&d(t.target.href,{ignoreSlowConnection:!0})},{passive:!0})}function L(){let e;document.body.addEventListener("focusin",r=>{s(r.target,"hover")&&t(r)},{passive:!0}),document.body.addEventListener("focusout",n,{passive:!0}),h(()=>{for(const r of document.getElementsByTagName("a"))l.has(r)||s(r,"hover")&&(l.add(r),r.addEventListener("mouseenter",t,{passive:!0}),r.addEventListener("mouseleave",n,{passive:!0}))});function t(r){const o=r.target.href;e&&clearTimeout(e),e=setTimeout(()=>{d(o)},80)}function n(){e&&(clearTimeout(e),e=0)}}function T(){let e;h(()=>{for(const t of document.getElementsByTagName("a"))l.has(t)||s(t,"viewport")&&(l.add(t),e!=null||(e=b()),e.observe(t))})}function b(){const e=new WeakMap;return new IntersectionObserver((t,n)=>{for(const r of t){const o=r.target,i=e.get(o);r.isIntersecting?(i&&clearTimeout(i),e.set(o,setTimeout(()=>{n.unobserve(o),e.delete(o),d(o.href)},300))):i&&(clearTimeout(i),e.delete(o))}})}function k(){h(()=>{for(const e of document.getElementsByTagName("a"))s(e,"load")&&d(e.href)})}function d(e,t){var r,o,i,f,m;e=e.replace(/#.*/,"");const n=(r=t==null?void 0:t.ignoreSlowConnection)!=null?r:!1;if(H(e,n))if(g.add(e),(o=HTMLScriptElement.supports)!=null&&o.call(HTMLScriptElement,"speculationrules"))C(e,(i=t==null?void 0:t.eagerness)!=null?i:"immediate");else if((m=(f=document.createElement("link").relList)==null?void 0:f.supports)!=null&&m.call(f,"prefetch")&&(t==null?void 0:t.with)!=="fetch"){const a=document.createElement("link");a.rel="prefetch",a.setAttribute("href",e),document.head.append(a)}else{const a=new Headers;for(const[w,y]of Object.entries(S))a.set(w,y);fetch(e,{priority:"low",headers:a})}}function H(e,t){if(!navigator.onLine||!t&&p())return!1;try{const n=new URL(e,location.href);return location.origin===n.origin&&(location.pathname!==n.pathname||location.search!==n.search)&&!g.has(e)}catch(n){}return!1}function s(e,t){if((e==null?void 0:e.tagName)!=="A")return!1;const n=e.dataset.astroPrefetch;return n==="false"?!1:t==="tap"&&(n!=null||c)&&p()?!0:n==null&&c||n===""?t===u:n===t}function p(){if("connection"in navigator){const e=navigator.connection;return e.saveData||/2g/.test(e.effectiveType)}return!1}function h(e){e();let t=!1;document.addEventListener("astro:page-load",()=>{if(!t){t=!0;return}e()})}function C(e,t){const n=document.createElement("script");n.type="speculationrules",n.textContent=JSON.stringify({prerender:[{source:"list",urls:[e],eagerness:t}],prefetch:[{source:"list",urls:[e],eagerness:t}]}),document.head.append(n)}export{S as a,N as i};
